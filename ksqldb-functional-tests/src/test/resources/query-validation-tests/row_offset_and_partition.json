{
  "comments": [
    "Tests ensuring ROWPARTITON and ROWOFFSET work as user column names before KLIP-50 is integrated"
  ],
  "tests": [
    {
      "name": "create ROWOFFSET user column",
      "statements": [
        "CREATE STREAM INPUT (id int KEY, name STRING) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT id, name as ROWOFFSET FROM INPUT;"
      ],
      "inputs": [
        {"topic":  "test_topic", "key": 1, "value": {"name": "a"}}
      ],
      "outputs": [
        {"topic":  "OUTPUT", "key": 1, "value": {"ROWOFFSET": "a"}}
      ],
      "post": {
        "sources": [
          {"name": "OUTPUT", "type": "stream", "schema": "ID INT KEY, ROWOFFSET STRING"}
        ]
      }
    },
    {
      "name": "create ROWPARTITION user column",
      "statements": [
        "CREATE STREAM INPUT (id int KEY, name STRING) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT id, name as ROWPARTITION FROM INPUT;"
      ],
      "inputs": [
        {"topic":  "test_topic", "key": 1, "value": {"name": "a"}}
      ],
      "outputs": [
        {"topic":  "OUTPUT", "key": 1, "value": {"ROWPARTITION": "a"}}
      ],
      "post": {
        "sources": [
          {"name": "OUTPUT", "type": "stream", "schema": "ID INT KEY, ROWPARTITION STRING"}
        ]
      }
    }
  ]
}