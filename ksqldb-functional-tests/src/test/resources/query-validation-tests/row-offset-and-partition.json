{
  "comments": [
    "Tests covering ROWPARTITION and ROWOFFSET"
  ],
  "tests": [
    {
      "name": "create ROWOFFSET and ROWPARTITION sink user columns as STRINGs",
      "properties": {
        "ksql.rowpartition.rowoffset.enabled": true
      },
      "statements": [
        "CREATE STREAM input (id INT KEY, val STRING, other_val STRING) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM output AS SELECT id, val AS ROWPARTITION, other_val AS ROWOFFSET FROM input;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "`ROWPARTITION` is a reserved column name. You cannot use it as an alias for a column."
      }
    },
    {
      "name": "test ROWOFFSET and ROWPARTITION sink user columns with pseudocolumn data types",
      "properties": {
        "ksql.rowpartition.rowoffset.enabled": true
      },
      "statements": [
        "CREATE STREAM input (id INT KEY, val INTEGER, other_val BIGINT) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM output AS SELECT id, val AS ROWPARTITION, other_val AS ROWOFFSET FROM input;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "`ROWPARTITION` is a reserved column name. You cannot use it as an alias for a column."
      }
    },
    {
      "name": "create ROWOFFSET and ROWPARTITION source user columns as STRINGs",
      "properties": {
        "ksql.rowpartition.rowoffset.enabled": true
      },
      "statements": [
        "CREATE STREAM input (id INT KEY, ROWPARTITION string, ROWOFFSET string) WITH (kafka_topic='test_topic', value_format='JSON');"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "'ROWPARTITION' is a reserved column name. You cannot use it as a name for a column."
      }
    },
    {
      "name": "test ROWOFFSET and ROWPARTITION source user columns with pseudocolumn data types",
      "properties": {
        "ksql.rowpartition.rowoffset.enabled": true
      },
      "statements": [
        "CREATE STREAM INPUT (id int KEY, ROWPARTITION INTEGER, ROWOFFSET BIGINT) WITH (kafka_topic='test_topic', value_format='JSON');"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "'ROWPARTITION' is a reserved column name. You cannot use it as a name for a column."
      }
    }
  ]
}